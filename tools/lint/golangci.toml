# golangci-lint configuration (v2)
# https://golangci-lint.run/usage/configuration/
#
# Run via wrapper (uses tools.go.mod and this config):
#   golangci-lint run          # uses .envrc shell function
#   just lint                  # justfile recipe

version = "2"

[run]
timeout = "5m"
modules-download-mode = "readonly"

[linters]
# Use standard preset which includes most common linters
default = "standard"

# Enable additional linters for idiomatic Go code
enable = [
  "gocritic",   # Opinionated linter with many good checks
  "unconvert",  # Remove unnecessary type conversions
  "prealloc",   # Suggest slice preallocation
  "nolintlint", # Ensure //nolint comments are properly used
  "whitespace", # Leading/trailing whitespace
  "revive",     # Replacement for golint
]
# Note: gofumpt removed - golangci-lint v2.8.0 treats formatters separately

[linters.settings.errcheck]
check-type-assertions = false
check-blank = false

[linters.settings.govet]
enable-all = true
disable = ["shadow", "fieldalignment"]

[linters.settings.staticcheck]
checks = ["all", "-ST1023", "-S1009", "-QF*"]

[linters.settings.gocritic]
enabled-tags = ["diagnostic", "style", "opinionated"]
disabled-checks = [
  "paramTypeCombine", # Style preference
]

[linters.settings.revive]
severity = "warning"
rules = [
  { name = "blank-imports" },
  { name = "context-as-argument" },
  { name = "context-keys-type" },
  { name = "dot-imports" },
  { name = "error-return" },
  { name = "error-strings" },
  { name = "error-naming" },
  { name = "exported" },
  { name = "increment-decrement" },
  { name = "var-naming" },
  { name = "package-comments" },
  { name = "range" },
  { name = "receiver-naming" },
  { name = "time-naming" },
  { name = "indent-error-flow" },
  { name = "errorf" },
  { name = "empty-block" },
  { name = "superfluous-else" },
  { name = "unreachable-code" },
]

[linters.exclusions]
presets = ["comments", "std-error-handling", "common-false-positives"]

[[linters.exclusions.rules]]
path = "_test\\.go"
linters = ["funlen", "unused", "gocritic"]

[[linters.exclusions.rules]]
path = "testdata"
linters = ["all"]

[issues]
max-issues-per-linter = 50
max-same-issues = 10
