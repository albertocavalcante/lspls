Test union type generation with Or_* types and JSON marshal/unmarshal.
Union types (kind: "or") generate named Or_* types with proper JSON handling.

-- input.json --
{
  "metaData": {"version": "3.17.0"},
  "structures": [
    {
      "name": "TextEdit",
      "documentation": "A text edit.",
      "properties": [
        {
          "name": "newText",
          "type": {"kind": "base", "name": "string"},
          "documentation": "The new text."
        }
      ]
    },
    {
      "name": "AnnotatedTextEdit",
      "documentation": "An annotated text edit.",
      "properties": [
        {
          "name": "newText",
          "type": {"kind": "base", "name": "string"},
          "documentation": "The new text."
        },
        {
          "name": "annotationId",
          "type": {"kind": "base", "name": "string"},
          "documentation": "The annotation ID."
        }
      ]
    },
    {
      "name": "TextDocumentEdit",
      "documentation": "Describes textual changes on a text document.",
      "properties": [
        {
          "name": "edits",
          "type": {
            "kind": "array",
            "element": {
              "kind": "or",
              "items": [
                {"kind": "reference", "name": "TextEdit"},
                {"kind": "reference", "name": "AnnotatedTextEdit"}
              ]
            }
          },
          "documentation": "The edits to be applied."
        }
      ]
    }
  ],
  "enumerations": [],
  "typeAliases": []
}

-- want/protocol.go --
// Code generated by lspls. DO NOT EDIT.
package protocol

import (
	"encoding/json"
	"fmt"
)

// An annotated text edit.
type AnnotatedTextEdit struct {
	// The new text.
	NewText string `json:"newText"`
	// The annotation ID.
	AnnotationId string `json:"annotationId"`
}

// Describes textual changes on a text document.
type TextDocumentEdit struct {
	// The edits to be applied.
	Edits []Or_AnnotatedTextEdit_TextEdit `json:"edits"`
}

// A text edit.
type TextEdit struct {
	// The new text.
	NewText string `json:"newText"`
}

// Or_AnnotatedTextEdit_TextEdit is a union type for: AnnotatedTextEdit | TextEdit
type Or_AnnotatedTextEdit_TextEdit struct {
	Value any `json:"value"`
}

func (t Or_AnnotatedTextEdit_TextEdit) MarshalJSON() ([]byte, error) {
	switch x := t.Value.(type) {
	case AnnotatedTextEdit:
		return json.Marshal(x)
	case TextEdit:
		return json.Marshal(x)
	case nil:
		return []byte("null"), nil
	}
	return nil, fmt.Errorf("type %T not one of [AnnotatedTextEdit TextEdit]", t.Value)
}

func (t *Or_AnnotatedTextEdit_TextEdit) UnmarshalJSON(x []byte) error {
	if string(x) == "null" {
		t.Value = nil
		return nil
	}
	var h0 AnnotatedTextEdit
	if err := json.Unmarshal(x, &h0); err == nil {
		t.Value = h0
		return nil
	}
	var h1 TextEdit
	if err := json.Unmarshal(x, &h1); err == nil {
		t.Value = h1
		return nil
	}
	return fmt.Errorf("unmarshal failed to match one of [AnnotatedTextEdit TextEdit]")
}
